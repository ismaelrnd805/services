<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Dashboard - Multi-Services Num√©riques</title>
    <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="../assets/css/bootstrap-icons.css">
    <link rel="stylesheet" href="../assets/css/dashboard.css">
    <link rel="stylesheet" href="../assets/css/rapports.css">
   <style>
/* Styles pour le tableau rapports */
#tableau-rapports tr {
    cursor: pointer;
    transition: background-color 0.2s;
}

#tableau-rapports tr:hover {
    background-color: #f8f9fa;
}

#tableau-rapports tr.selected {
    background-color: #e3f2fd;
    border-left: 3px solid #2196F3;
}

.checklist-table-item {
    transition: background-color 0.2s;
}

.checklist-table-item:hover {
    background-color: #f8f9fa;
}

.checklist-table-item td {
    vertical-align: top;
    padding: 12px 8px;
}

.checklist-category-header {
    background-color: #e9ecef;
    font-weight: 600;
    color: #495057;
}

/* Badges pour les statistiques */
.badge-modifications {
    background-color: #17a2b8;
    color: white;
}

/* Responsive */
@media (max-width: 768px) {
    #tableau-rapports th:nth-child(2),
    #tableau-rapports td:nth-child(2),
    #tableau-rapports th:nth-child(5),
    #tableau-rapports td:nth-child(5) {
        display: none;
    }
}

/* Am√©liorations pour la navigation mobile */
@media (max-width: 991.98px) {
    .navbar-collapse {
        transition: all 0.3s ease;
        max-height: 80vh;
        overflow-y: auto;
    }
    
    .navbar-nav .nav-link {
        padding: 12px 15px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        transition: all 0.3s ease;
    }
    
    .navbar-nav .nav-link:last-child {
        border-bottom: none;
    }
    
    .navbar-nav .nav-link:hover,
    .navbar-nav .nav-link.active {
        background-color: rgba(255, 255, 255, 0.1);
        padding-left: 20px;
    }
    
    /* Am√©lioration du dropdown utilisateur sur mobile */
    .navbar-nav .dropdown-menu {
        border: none;
        background-color: rgba(255, 255, 255, 0.95);
    }
    
    .navbar-nav .dropdown-item {
        padding: 10px 15px;
    }
    
    /* Animation de fermeture de la navbar */
    .navbar-collapse.collapsing {
        transition: height 0.35s ease;
    }
}

/* Badge de notifications dans la navbar */
.notification-badge {
    position: absolute;
    top: 5px;
    right: 5px;
    background-color: #dc3545;
    color: white;
    border-radius: 50%;
    padding: 2px 6px;
    font-size: 0.7rem;
    min-width: 18px;
    text-align: center;
}

/* Transition pour les sections */
.section {
    display: none;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.section.active {
    display: block;
    opacity: 1;
}

/* Am√©lioration de l'en-t√™te */
.section-header {
    padding: 10px 0;
    border-bottom: 1px solid #dee2e6;
    margin-bottom: 20px;
}

/* Boutons responsifs */
.btn-custom {
    transition: all 0.3s ease;
}

.btn-custom:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

@media (max-width: 768px) {
    .btn-custom {
        font-size: 0.875rem;
        padding: 0.375rem 0.75rem;
    }
    
    .section-header {
        flex-direction: column;
        gap: 10px;
        align-items: flex-start !important;
    }
    
    .section-header h1,
    .section-header h2 {
        font-size: 1.25rem;
    }
}

/* Corrections sp√©cifiques pour les tableaux responsives */
.table-responsive-custom {
    width: 100%;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    border: 1px solid #dee2e6;
    border-radius: 0.375rem;
    background: white;
}

.table-responsive-custom table {
    width: 100%;
    margin-bottom: 0;
    border-collapse: collapse;
}

/* Optimisation pour √©crans moyens */
@media (max-width: 1200px) {
    .table-responsive-custom table {
        min-width: auto;
    }
}

/* Optimisation pour tablettes */
@media (max-width: 992px) {
    .table-responsive-custom {
        font-size: 0.9rem;
    }
}

/* Optimisation pour mobile - AFFICHAGE MINIMAL */
@media (max-width: 768px) {
    .table-responsive-custom {
        font-size: 0.85rem;
        border: none;
        background: transparent;
    }
    
    .table-responsive-custom table {
        min-width: 100% !important;
    }
    
    /* SUR MOBILE: Afficher UNIQUEMENT case √† cocher, client et actions */
    .table-responsive-custom table th:nth-child(1),
    .table-responsive-custom table td:nth-child(1),
    .table-responsive-custom table th:nth-child(3),
    .table-responsive-custom table td:nth-child(3),
    .table-responsive-custom table th:nth-child(9),
    .table-responsive-custom table td:nth-child(9) {
        display: table-cell;
    }
    
    /* Cacher TOUTES les autres colonnes sur mobile */
    .table-responsive-custom table th:nth-child(2),
    .table-responsive-custom table td:nth-child(2),
    .table-responsive-custom table th:nth-child(4),
    .table-responsive-custom table td:nth-child(4),
    .table-responsive-custom table th:nth-child(5),
    .table-responsive-custom table td:nth-child(5),
    .table-responsive-custom table th:nth-child(6),
    .table-responsive-custom table td:nth-child(6),
    .table-responsive-custom table th:nth-child(7),
    .table-responsive-custom table td:nth-child(7),
    .table-responsive-custom table th:nth-child(8),
    .table-responsive-custom table td:nth-child(8) {
        display: none;
    }
    
    /* Optimiser l'affichage des colonnes visibles sur mobile */
    .table-responsive-custom table th:nth-child(1),
    .table-responsive-custom table td:nth-child(1) {
        width: 10%;
        min-width: 40px;
        text-align: center;
    }
    
    .table-responsive-custom table th:nth-child(3),
    .table-responsive-custom table td:nth-child(3) {
        width: 50%;
        min-width: 120px;
        font-weight: 600;
        color: var(--primary-color);
    }
    
    .table-responsive-custom table th:nth-child(9),
    .table-responsive-custom table td:nth-child(9) {
        width: 40%;
        min-width: 140px;
    }
    
    /* Case √† cocher plus visible sur mobile */
    .commande-checkbox {
        transform: scale(1.2);
        margin: 0 auto;
    }
    
    /* Nom du client optimis√© */
    .table-responsive-custom table td:nth-child(3) {
        font-size: 0.9rem;
        font-weight: 600;
        padding: 12px 8px;
    }
    
    /* Actions optimis√©es pour mobile */
    .actions-grid {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 3px;
        min-width: auto;
    }
    
    .actions-grid .btn {
        padding: 4px 6px !important;
        font-size: 0.7rem;
        min-width: 0;
    }
    
    .actions-grid .btn i {
        font-size: 0.75rem;
        margin: 0 !important;
    }
}

/* Pour les tr√®s petits √©crans */
@media (max-width: 412px) {
    .table-responsive-custom table th:nth-child(1),
    .table-responsive-custom table td:nth-child(1) {
        width: 8%;
        min-width: 35px;
    }
    
    .table-responsive-custom table th:nth-child(3),
    .table-responsive-custom table td:nth-child(3) {
        width: 45%;
        min-width: 100px;
        font-size: 0.85rem;
    }
    
    .table-responsive-custom table th:nth-child(9),
    .table-responsive-custom table td:nth-child(9) {
        width: 47%;
        min-width: 130px;
    }
    
    .actions-grid {
        grid-template-columns: 1fr !important;
    }
    
    .actions-grid .btn {
        padding: 3px 4px !important;
        font-size: 0.65rem;
    }
}
</style>
</head>
<body class="bg-light">
    <!-- Navigation principale -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary sticky-top">
        <div class="container-fluid">
            <a class="navbar-brand d-flex align-items-center" href="#">
                <img src="../logo.png" alt="Multi-Services Num√©riques" height="40" class="me-2">
                <span class="fw-bold d-none d-sm-block">Dashboard MSN</span>
            </a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" data-section="tableau-bord">
                            <i class="bi bi-speedometer2 me-1"></i>Tableau de Bord
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-section="commandes">
                            <i class="bi bi-clipboard-check me-1"></i>Commandes
                        </a>
                    </li>
                    <li class="nav-item position-relative">
                        <a class="nav-link" href="#" data-section="notifications">
                            <i class="bi bi-bell me-1"></i>Notifications
                            <span id="badge-notifications-nav" class="notification-badge" style="display: none;">0</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-section="clients">
                            <i class="bi bi-people me-1"></i>Clients
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-section="finances">
                            <i class="bi bi-currency-euro me-1"></i>Finances
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-section="parametres">
                            <i class="bi bi-gear me-1"></i>Param√®tres
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-section="cabine-technique">
                            <i class="bi bi-tools me-1"></i>Cabine Technique
                        </a>
                    </li>
                </ul>
                
                <div class="navbar-nav align-items-center">
                    <div class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button" data-bs-toggle="dropdown">
                            <div class="me-2 text-end d-none d-md-block">
                                <div class="fw-bold" id="nom-utilisateur"></div>
                                <small class="text-light-emphasis" id="currentDate"></small>
                            </div>
                            <i class="bi bi-person-circle fs-5"></i>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="#" onclick="deconnexion()"><i class="bi bi-box-arrow-right me-2"></i>D√©connexion</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Contenu principal -->
    <div class="container-fluid py-3">
        <!-- En-t√™te de section -->
        <div class="d-flex justify-content-between align-items-center mb-3 section-header">
            <h1 id="titre-section" class="h4 mb-0 text-primary">Tableau de Bord</h1>
            <div id="header-notifications" class="d-none position-relative">
                <button class="btn btn-outline-primary btn-custom" onclick="showSection('notifications')">
                    <i class="bi bi-bell"></i>
                    <span id="notification-count" class="notification-badge">0</span>
                </button>
            </div>
        </div>

        <!-- Tableau de Bord -->
        <div id="tableau-bord" class="section active">
            <!-- Cartes de statistiques -->
            <div class="stats-grid" id="stats-cards">
                <!-- G√©n√©r√© dynamiquement -->
            </div>

            <div class="row g-3">
                <!-- Notifications r√©centes -->
                <div class="col-12 col-lg-6">
                    <div class="card h-100">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0"><i class="bi bi-bell me-2"></i>Notifications R√©centes</h5>
                            <button onclick="showSection('notifications')" class="btn btn-primary btn-custom btn-custom-sm">
                                <i class="bi bi-arrow-right me-1"></i>Voir toutes
                            </button>
                        </div>
                        <div class="card-body" id="notifications-recentes">
                            <!-- G√©n√©r√© dynamiquement -->
                        </div>
                    </div>
                </div>

                <!-- Commandes r√©centes -->
                <div class="col-12 col-lg-6">
                    <div class="card h-100">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="bi bi-clipboard-check me-2"></i>Commandes R√©centes</h5>
                        </div>
                        <div class="card-body p-0">
                            <div class="table-responsive" style="max-height: 400px; overflow-y: auto;">
                                <div id="commandes-recentes" class="p-2">
                                    <!-- G√©n√©r√© dynamiquement -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Panel de debug -->
            <div class="card mt-3">
                <div class="card-header">
                    <button class="btn btn-link p-0 text-decoration-none w-100 text-start" type="button" data-bs-toggle="collapse" data-bs-target="#debugPanel">
                        <i class="bi bi-tools me-2"></i>Informations D√©bugage
                    </button>
                </div>
                <div class="collapse" id="debugPanel">
                    <div class="card-body">
                        <div class="row mobile-optimized">
                            <div class="col-md-6">
                                <p><strong>Commandes totales:</strong> <span id="debugTotalCommandes">0</span></p>
                                <p><strong>Notifications:</strong> <span id="debugTotalNotifications">0</span> total, <span id="debugNotificationsNonLues">0</span> non lues</p>
                                <p><strong>Derni√®re mise √† jour:</strong> <span id="debugLastUpdate">-</span></p>
                            </div>
                            <div class="col-md-6">
                                <div class="d-grid gap-2">
                                    <button onclick="testerNotifications()" class="btn btn-outline-primary btn-custom">
                                        <i class="bi bi-bell me-1"></i>Tester notifications
                                    </button>
                                    <button onclick="actualiserDonnees()" class="btn btn-outline-primary btn-custom">
                                        <i class="bi bi-arrow-clockwise me-1"></i>Actualiser
                                    </button>
                                    <button onclick="viderDonnees()" class="btn btn-outline-danger btn-custom">
                                        <i class="bi bi-trash me-1"></i>Vider donn√©es test
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Commandes Section - STRUCTURE CORRIG√âE -->
        <div id="commandes" class="section">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2>üìã Gestion des Commandes</h2>
                <button onclick="ajouterNouvelleCommande()" class="btn btn-success btn-lg">
                    <i class="bi bi-plus-circle me-2"></i> Nouvelle Commande
                </button>
            </div>

            <!-- Actions rapides pour s√©lection multiple -->
            <div id="actions-rapides-commandes" class="alert alert-info mb-3" style="display: none;">
                <div class="d-flex justify-content-between align-items-center">
                    <span id="nombre-commandes-selectionnees">0 commande(s) s√©lectionn√©e(s)</span>
                    <div class="btn-group">
                        <button onclick="changerStatutMultiple()" class="btn btn-primary btn-sm">
                            <i class="bi bi-arrow-right-circle me-1"></i>Changer statut
                        </button>
                        <button onclick="exporterCommandesSelection()" class="btn btn-success btn-sm">
                            <i class="bi bi-download me-1"></i>Exporter
                        </button>
                        <button onclick="deselectionnerToutesCommandes()" class="btn btn-secondary btn-sm">
                            <i class="bi bi-x-circle me-1"></i>Annuler
                        </button>
                    </div>
                </div>
            </div>

            <!-- Navigation par onglets -->
            <ul class="nav nav-tabs mb-3" id="ordersTab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#toutes" type="button">
                        Toutes <span id="count-toutes" class="badge bg-secondary ms-1">0</span>
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#devis" type="button">
                        Devis <span id="count-devis" class="badge bg-secondary ms-1">0</span>
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#traitement" type="button">
                        En Traitement <span id="count-traitement" class="badge bg-secondary ms-1">0</span>
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#termine" type="button">
                        Termin√©es <span id="count-termine" class="badge bg-secondary ms-1">0</span>
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#paye" type="button">
                        Pay√©es <span id="count-paye" class="badge bg-secondary ms-1">0</span>
                    </button>
                </li>
            </ul>

            <!-- Contenu des onglets -->
            <div class="tab-content" id="ordersTabContent">
                <div class="tab-pane fade show active" id="toutes" role="tabpanel">
                    <div class="table-responsive-custom">
                        <table class="table table-hover">
                            <!-- <thead>
                                <tr>
                                    <th width="5%">
                                        <input type="checkbox" id="select-all-commandes" onchange="toggleSelectAllCommandes(this)">
                                    </th>
                                    <th width="10%">R√©f</th>
                                    <th width="20%">Client</th>
                                    <th width="15%">Service</th>
                                    <th width="10%">Statut</th>
                                    <th width="10%">Paiement</th>
                                    <th width="10%">Validation</th>
                                    <th width="10%">Date</th>
                                    <th width="20%">Actions</th>
                                </tr>
                            </thead> -->
                            <tbody id="liste-commandes">
                                <!-- G√©n√©r√© dynamiquement -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="tab-pane fade" id="devis" role="tabpanel">
                    <div class="table-responsive-custom">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th width="5%">
                                        <input type="checkbox" class="select-all-tab" data-tab="devis">
                                    </th>
                                    <th width="10%">R√©f</th>
                                    <th width="20%">Client</th>
                                    <th width="15%">Service</th>
                                    <th width="10%">Statut</th>
                                    <th width="10%">Paiement</th>
                                    <th width="10%">Validation</th>
                                    <th width="10%">Date</th>
                                    <th width="20%">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="liste-commandes-devis">
                                <!-- G√©n√©r√© dynamiquement -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="tab-pane fade" id="traitement" role="tabpanel">
                    <div class="table-responsive-custom">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th width="5%">
                                        <input type="checkbox" class="select-all-tab" data-tab="traitement">
                                    </th>
                                    <th width="10%">R√©f</th>
                                    <th width="20%">Client</th>
                                    <th width="15%">Service</th>
                                    <th width="10%">Statut</th>
                                    <th width="10%">Paiement</th>
                                    <th width="10%">Validation</th>
                                    <th width="10%">Date</th>
                                    <th width="20%">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="liste-commandes-traitement">
                                <!-- G√©n√©r√© dynamiquement -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="tab-pane fade" id="termine" role="tabpanel">
                    <div class="table-responsive-custom">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th width="5%">
                                        <input type="checkbox" class="select-all-tab" data-tab="termine">
                                    </th>
                                    <th width="10%">R√©f</th>
                                    <th width="20%">Client</th>
                                    <th width="15%">Service</th>
                                    <th width="10%">Statut</th>
                                    <th width="10%">Paiement</th>
                                    <th width="10%">Validation</th>
                                    <th width="10%">Date</th>
                                    <th width="20%">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="liste-commandes-termine">
                                <!-- G√©n√©r√© dynamiquement -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="tab-pane fade" id="paye" role="tabpanel">
                    <div class="table-responsive-custom">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th width="5%">
                                        <input type="checkbox" class="select-all-tab" data-tab="paye">
                                    </th>
                                    <th width="10%">R√©f</th>
                                    <th width="20%">Client</th>
                                    <th width="15%">Service</th>
                                    <th width="10%">Statut</th>
                                    <th width="10%">Paiement</th>
                                    <th width="10%">Validation</th>
                                    <th width="10%">Date</th>
                                    <th width="20%">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="liste-commandes-paye">
                                <!-- G√©n√©r√© dynamiquement -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Notifications Section -->
        <div id="notifications" class="section">
            <div class="d-flex justify-content-between align-items-center mb-3 section-header">
                <h2 class="h5 mb-0"><i class="bi bi-bell me-2"></i>Gestion des Notifications</h2>
                <div class="d-flex gap-2 flex-wrap">
                    <button onclick="actualiserNotifications()" class="btn btn-primary btn-custom btn-custom-sm">
                        <i class="bi bi-arrow-clockwise me-1"></i>Actualiser
                    </button>
                    <button onclick="marquerToutesCommeLues()" class="btn btn-success btn-custom btn-custom-sm">
                        <i class="bi bi-check-all me-1"></i>Tout marquer comme lu
                    </button>
                    <button onclick="supprimerNotificationsLues()" class="btn btn-danger btn-custom btn-custom-sm">
                        <i class="bi bi-trash me-1"></i>Supprimer lues
                    </button>
                </div>
            </div>

            <!-- Navigation par onglets -->
            <ul class="nav nav-tabs mb-3" id="notificationsTab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#notif-toutes" type="button">
                        Toutes <span id="count-notif-toutes" class="badge bg-secondary ms-1">0</span>
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#notif-non-lues" type="button">
                        Non lues <span id="count-notif-non-lues" class="badge bg-secondary ms-1">0</span>
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#notif-alertes" type="button">
                        Alertes <span id="count-notif-alertes" class="badge bg-secondary ms-1">0</span>
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#notif-rappels" type="button">
                        Rappels <span id="count-notif-rappels" class="badge bg-secondary ms-1">0</span>
                    </button>
                </li>
            </ul>

            <!-- Contenu des onglets -->
            <div class="tab-content" id="notificationsTabContent">
                <div class="tab-pane fade show active" id="notif-toutes" role="tabpanel">
                    <div id="liste-notifications">
                        <!-- G√©n√©r√© dynamiquement -->
                    </div>
                </div>
                <div class="tab-pane fade" id="notif-non-lues" role="tabpanel">
                    <div id="liste-notifications-non-lues">
                        <!-- G√©n√©r√© dynamiquement -->
                    </div>
                </div>
                <div class="tab-pane fade" id="notif-alertes" role="tabpanel">
                    <div id="liste-notifications-alertes">
                        <!-- G√©n√©r√© dynamiquement -->
                    </div>
                </div>
                <div class="tab-pane fade" id="notif-rappels" role="tabpanel">
                    <div id="liste-notifications-rappels">
                        <!-- G√©n√©r√© dynamiquement -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Clients Section -->
        <div id="clients" class="section">
            <h2 class="h5 mb-4"><i class="bi bi-people me-2"></i>Gestion des Clients</h2>
            <div id="liste-clients">
                <div class="alert alert-info">
                    <i class="bi bi-info-circle me-2"></i>Fonctionnalit√© en d√©veloppement...
                </div>
            </div>
        </div>

        <!-- Finances Section -->
        <div id="finances" class="section">
            <h2 class="h5 mb-4"><i class="bi bi-currency-euro me-2"></i>Tableau de Bord Financier</h2>
            <div id="stats-finances">
                <div class="alert alert-info">
                    <i class="bi bi-info-circle me-2"></i>Fonctionnalit√© en d√©veloppement...
                </div>
            </div>
        </div>

        <!-- SECTION CALENDRIER √âDITORIAL -->
        <div id="calendrier-editorial" class="section">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="h4 mb-0"><i class="bi bi-calendar-check me-2"></i>Calendrier √âditorial - 3 Mois</h2>
                <div class="d-flex gap-2 flex-wrap">
                    <button onclick="genererCalendrierAutomatique()" class="btn btn-success">
                        <i class="bi bi-robot me-2"></i>G√©n√©rer avec IA
                    </button>
                    <button onclick="afficherModalNouvellePublication()" class="btn btn-primary">
                        <i class="bi bi-plus-circle me-2"></i>Nouvelle Publication
                    </button>
                    <button onclick="exporterCalendrier()" class="btn btn-outline-primary">
                        <i class="bi bi-download me-2"></i>Exporter
                    </button>
                </div>
            </div>

            <!-- Statistiques -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h3 id="stats-pubs-programmees" class="text-primary">0</h3>
                            <p class="text-muted mb-0">Programm√©es</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h3 id="stats-pubs-mois" class="text-success">0</h3>
                            <p class="text-muted mb-0">Ce mois</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h3 id="stats-pubs-semaine" class="text-warning">0</h3>
                            <p class="text-muted mb-0">Cette semaine</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h3 id="stats-themes" class="text-info">0</h3>
                            <p class="text-muted mb-0">Th√®mes diff√©rents</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Liste des publications -->
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="bi bi-list-check me-2"></i>Publications Programm√©es (3 prochains mois)</h5>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-hover mb-0">
                            <thead>
                                <tr>
                                    <th width="12%">Date</th>
                                    <th width="15%">Th√®me</th>
                                    <th width="43%">Contenu</th>
                                    <th width="10%">Statut</th>
                                    <th width="20%">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="liste-publications">
                                <tr>
                                    <td colspan="5" class="text-center py-4">
                                        <div class="empty-state">
                                            <div class="icon">üìÖ</div>
                                            <h4>Aucune publication programm√©e</h4>
                                            <p>Utilisez l'IA pour g√©n√©rer automatiquement un calendrier</p>
                                            <button onclick="genererCalendrierAutomatique()" class="btn btn-primary mt-2">
                                                <i class="bi bi-robot me-2"></i>G√©n√©rer avec IA
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Param√®tres Section -->
        <div id="parametres" class="section">
            <h2 class="h5 mb-4"><i class="bi bi-gear me-2"></i>Param√®tres de l'Entreprise</h2>
            <div id="parametres-content">
                <div class="row">
                    <div class="col-md-6">
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">Informations Entreprise</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Nom de l'entreprise:</label>
                                    <input type="text" id="param-nom" class="form-control" value="Multi-Services Num√©riques">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">T√©l√©phones:</label>
                                    <input type="text" id="param-telephone" class="form-control" value="+261 34 396 77 44 / 033 18 444 53 / 032 26 803 69">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Email:</label>
                                    <input type="email" id="param-email" class="form-control" value="multi.snumerique@gmail.com">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">Mobile Money</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Mvola:</label>
                                    <input type="text" id="param-mvola" class="form-control" value="034 39 677 44">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Airtel Money:</label>
                                    <input type="text" id="param-airtel" class="form-control" value="033 18 444 53">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Orange Money:</label>
                                    <input type="text" id="param-orange" class="form-control" value="032 26 803 69">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="bi bi-bell me-2"></i>Param√®tres des Notifications</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="param-notif-nouvelles" checked>
                                    <label class="form-check-label" for="param-notif-nouvelles">
                                        Notifications pour nouvelles commandes
                                    </label>
                                </div>
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="param-notif-paiement" checked>
                                    <label class="form-check-label" for="param-notif-paiement">
                                        Rappels automatiques de paiement
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="param-notif-retard" checked>
                                    <label class="form-check-label" for="param-notif-retard">
                                        Alertes pour commandes en retard
                                    </label>
                                </div>
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="param-notif-termine" checked>
                                    <label class="form-check-label" for="param-notif-termine">
                                        Notifications pour commandes termin√©es
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Intervalle des rappels (heures):</label>
                            <input type="number" id="param-interval-rappels" class="form-control" value="24" min="1" max="168">
                        </div>
                    </div>
                </div>
                
                <button onclick="sauvegarderParametres()" class="btn btn-success btn-custom">
                    <i class="bi bi-save me-2"></i>Sauvegarder les param√®tres
                </button>
            </div>
        </div>

        <!-- Cabine Technique Section -->
        <div id="cabine-technique" class="section">
            <!-- Test des th√®mes -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0"><i class="bi bi-palette me-2"></i>Test des Th√®mes</h5>
                </div>
                <div class="card-body">
                    <div class="d-flex gap-2 flex-wrap">
                        <button onclick="testerTheme('bleu')" class="btn btn-primary">Th√®me Bleu</button>
                        <button onclick="testerTheme('vert')" class="btn btn-success">Th√®me Vert</button>
                        <button onclick="testerTheme('orange')" class="btn btn-warning">Th√®me Orange</button>
                        <button onclick="testerTheme('violet')" class="btn" style="background-color: #8e44ad; color: white;">Th√®me Violet</button>
                        <button onclick="testerModeSombre()" class="btn btn-dark">Basculer Mode Sombre</button>
                        <button onclick="reinitialiserTestTheme()" class="btn btn-outline-secondary">R√©initialiser</button>
                    </div>
                    <div class="mt-2">
                        <small class="text-muted">Ces changements sont temporaires. Cliquez sur "Sauvegarder" pour les appliquer d√©finitivement.</small>
                    </div>
                </div>
            </div>

            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="h4 mb-0"><i class="bi bi-tools me-2"></i>Cabine Technique</h2>
                <div class="d-flex gap-2 flex-wrap">
                    <button onclick="sauvegarderConfiguration()" class="btn btn-success btn-custom">
                        <i class="bi bi-save me-2"></i>Sauvegarder
                    </button>
                    <button onclick="reinitialiserConfiguration()" class="btn btn-warning btn-custom">
                        <i class="bi bi-arrow-clockwise me-2"></i>R√©initialiser
                    </button>
                </div>
            </div>

            <!-- Navigation par onglets -->
            <ul class="nav nav-tabs mb-4" id="techTab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#interface" type="button">
                        <i class="bi bi-palette me-1"></i>Interface
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#fonctionnalites" type="button">
                        <i class="bi bi-gear me-1"></i>Fonctionnalit√©s
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#notifications-tech" type="button">
                        <i class="bi bi-bell me-1"></i>Notifications
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#export" type="button">
                        <i class="bi bi-download me-1"></i>Export/Import
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#systeme" type="button">
                        <i class="bi bi-cpu me-1"></i>Syst√®me
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#services" type="button">
                        <i class="bi bi-list-check me-1"></i>Services
                    </button>
                </li>
            </ul>

            <!-- Contenu des onglets -->
            <div class="tab-content" id="techTabContent">
                <!-- Onglet Interface -->
                <div class="tab-pane fade show active" id="interface" role="tabpanel">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-4">
                                <div class="card-header">
                                    <h5 class="mb-0"><i class="bi bi-palette me-2"></i>Th√®mes et Couleurs</h5>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label class="form-label">Th√®me principal</label>
                                        <select id="theme-principal" class="form-select">
                                            <option value="bleu">Bleu Professionnel</option>
                                            <option value="vert">Vert Nature</option>
                                            <option value="orange">Orange √ânergique</option>
                                            <option value="violet">Violet Cr√©atif</option>
                                            <option value="sombre">Mode Sombre</option>
                                        </select>
                                    </div>
                                    <div class="row">
                                        <div class="col-6">
                                            <label class="form-label">Couleur primaire</label>
                                            <input type="color" id="couleur-primaire" class="form-control form-control-color" value="#2c3e50">
                                        </div>
                                        <div class="col-6">
                                            <label class="form-label">Couleur secondaire</label>
                                            <input type="color" id="couleur-secondaire" class="form-control form-control-color" value="#3498db">
                                        </div>
                                    </div>
                                    <div class="form-check form-switch mt-3">
                                        <input class="form-check-input" type="checkbox" id="mode-sombre" checked>
                                        <label class="form-check-label" for="mode-sombre">Mode sombre automatique</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card mb-4">
                                <div class="card-header">
                                    <h5 class="mb-0"><i class="bi bi-layout-sidebar me-2"></i>Disposition</h5>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label class="form-label">Type de navigation</label>
                                        <select id="type-navigation" class="form-select">
                                            <option value="sidebar">Sidebar lat√©rale</option>
                                            <option value="topbar">Navigation sup√©rieure</option>
                                            <option value="compact">Compacte</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Densit√© d'affichage</label>
                                        <select id="densite-affichage" class="form-select">
                                            <option value="comfort">Confortable</option>
                                            <option value="compact">Compacte</option>
                                            <option value="dense">Dense</option>
                                        </select>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="animations" checked>
                                        <label class="form-check-label" for="animations">Animations activ√©es</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Les autres onglets de la cabine technique restent inchang√©s -->
                <!-- ... -->

            </div>
        </div>

        <!-- Rapports Section -->
        <div id="rapports" class="section">
            <div class="d-flex justify-content-between align-items-center mb-3 section-header">
                <h2 class="h5 mb-0"><i class="bi bi-file-text me-2"></i>Gestion des Rapports</h2>
                <div class="d-flex gap-2 flex-wrap">
                    <button onclick="actualiserRapports()" class="btn btn-primary btn-custom btn-custom-sm">
                        <i class="bi bi-arrow-clockwise me-1"></i>Actualiser
                    </button>
                    <button onclick="genererRapportDepuisTableau()" class="btn btn-success btn-custom btn-custom-sm">
                        <i class="bi bi-file-pdf me-1"></i>G√©n√©rer PDF S√©lection
                    </button>
                </div>
            </div>

            <!-- Navigation par onglets -->
            <ul class="nav nav-tabs mb-3" id="rapportsTab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#nouveau-rapport" type="button">
                        <i class="bi bi-plus-circle me-1"></i>Nouveau Rapport
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#liste-rapports" type="button">
                        <i class="bi bi-list-ul me-1"></i>Rapports Existants
                        <span id="count-rapports" class="badge bg-secondary ms-1">0</span>
                    </button>
                </li>
            </ul>

            <!-- Contenu des onglets -->
            <div class="tab-content" id="rapportsTabContent">
                
                <!-- Onglet Nouveau Rapport -->
                <div class="tab-pane fade show active" id="nouveau-rapport" role="tabpanel">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="bi bi-plus-circle me-2"></i>Cr√©er un Nouveau Rapport</h5>
                        </div>
                        <div class="card-body">
                            <!-- Formulaire de cr√©ation de rapport -->
                        </div>
                    </div>
                </div>

                <!-- Onglet Liste Rapports -->
                <div class="tab-pane fade" id="liste-rapports" role="tabpanel">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0"><i class="bi bi-list-ul me-2"></i>Liste des Rapports</h5>
                            <div class="d-flex gap-2">
                                <button onclick="exporterTousRapports()" class="btn btn-success btn-sm">
                                    <i class="bi bi-download me-1"></i>Exporter tous
                                </button>
                            </div>
                        </div>
                        <div class="card-body p-0">
                            <div class="table-responsive">
                                <table class="table table-hover mb-0">
                                    <thead>
                                        <tr>
                                            <th width="5%">
                                                <input type="checkbox" id="select-all-rapports" onchange="toggleSelectAllRapports(this)">
                                            </th>
                                            <th width="15%">R√©f√©rence</th>
                                            <th width="20%">Client</th>
                                            <th width="20%">Document</th>
                                            <th width="15%">R√©dacteur</th>
                                            <th width="10%">Modifications</th>
                                            <th width="10%">Date</th>
                                            <th width="15%">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tableau-rapports">
                                        <!-- G√©n√©r√© dynamiquement -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
    // Correction de la navigation mobile
    document.addEventListener('DOMContentLoaded', function() {
        console.log('üöÄ Initialisation de la navigation mobile...');
        
        // Gestionnaire pour les liens de navigation
        const navLinks = document.querySelectorAll('.nav-link[data-section]');
        const navbarToggler = document.querySelector('.navbar-toggler');
        const navbarCollapse = document.querySelector('.navbar-collapse');
        
        navLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                const sectionId = this.getAttribute('data-section');
                console.log(`üì± Navigation vers: ${sectionId}`);
                
                // Fermer la navbar sur mobile
                if (window.innerWidth < 992) {
                    if (navbarCollapse && navbarCollapse.classList.contains('show')) {
                        if (typeof bootstrap !== 'undefined') {
                            const bsCollapse = bootstrap.Collapse.getInstance(navbarCollapse);
                            if (bsCollapse) {
                                bsCollapse.hide();
                            }
                        } else {
                            navbarCollapse.classList.remove('show');
                            if (navbarToggler) {
                                navbarToggler.setAttribute('aria-expanded', 'false');
                            }
                        }
                    }
                }
                
                // Changer de section apr√®s un court d√©lai pour la fermeture
                setTimeout(() => {
                    showSection(sectionId);
                }, 300);
            });
        });
        
        console.log('‚úÖ Navigation mobile initialis√©e');
    });

    // Version am√©lior√©e de showSection
    function showSection(sectionId) {
        console.log(`üìë Affichage de la section: ${sectionId}`);
        
        // Masquer toutes les sections
        document.querySelectorAll('.section').forEach(section => {
            section.classList.remove('active');
        });
        
        // D√©sactiver tous les liens de navigation
        document.querySelectorAll('.nav-link').forEach(link => {
            link.classList.remove('active');
        });
        
        // Activer la section cible
        const targetSection = document.getElementById(sectionId);
        const targetLink = document.querySelector(`[data-section="${sectionId}"]`);
        
        if (targetSection) {
            targetSection.classList.add('active');
            console.log(`‚úÖ Section ${sectionId} activ√©e`);
        }
        
        if (targetLink) {
            targetLink.classList.add('active');
        }
        
        // Mettre √† jour le titre de section
        const titreSection = document.getElementById('titre-section');
        if (titreSection) {
            const titres = {
                'tableau-bord': 'Tableau de Bord',
                'commandes': 'Gestion des Commandes',
                'notifications': 'Gestion des Notifications',
                'clients': 'Gestion des Clients',
                'finances': 'Tableau de Bord Financier',
                'parametres': 'Param√®tres de l\'Entreprise',
                'cabine-technique': 'Cabine Technique',
                'rapports': 'Gestion des Rapports'
            };
            titreSection.textContent = titres[sectionId] || 'Tableau de Bord';
        }
        
        // Actions sp√©cifiques par section
        switch(sectionId) {
            case 'tableau-bord':
                setTimeout(() => {
                    if (typeof actualiserTableauBord === 'function') {
                        actualiserTableauBord();
                    }
                }, 100);
                break;
            case 'commandes':
                setTimeout(() => {
                    if (typeof actualiserCommandes === 'function') {
                        actualiserCommandes();
                    }
                }, 100);
                break;
            case 'notifications':
                setTimeout(() => {
                    if (typeof actualiserNotifications === 'function') {
                        actualiserNotifications();
                    }
                }, 100);
                break;
        }
    }

    // Gestion du dropdown utilisateur
    document.addEventListener('DOMContentLoaded', function() {
        const dropdownToggle = document.querySelector('.nav-link.dropdown-toggle');
        if (dropdownToggle) {
            dropdownToggle.addEventListener('click', function(e) {
                // Emp√™cher la fermeture de la navbar sur mobile
                if (window.innerWidth < 992) {
                    e.stopPropagation();
                }
            });
        }
    });

    // Fonctions pour la s√©lection multiple des commandes
    function toggleSelectAllCommandes(checkbox) {
        const checkboxes = document.querySelectorAll('.commande-checkbox');
        checkboxes.forEach(cb => cb.checked = checkbox.checked);
        gererSelectionCommande();
    }

    function gererSelectionCommande() {
        const checkboxes = document.querySelectorAll('.commande-checkbox:checked');
        const panel = document.getElementById('actions-rapides-commandes');
        const countSpan = document.getElementById('nombre-commandes-selectionnees');
        
        if (checkboxes.length > 0) {
            panel.style.display = 'block';
            countSpan.textContent = `${checkboxes.length} commande(s) s√©lectionn√©e(s)`;
        } else {
            panel.style.display = 'none';
        }
    }

    function deselectionnerToutesCommandes() {
        document.querySelectorAll('.commande-checkbox').forEach(cb => cb.checked = false);
        gererSelectionCommande();
    }
    </script>

    <!-- √Ä la fin du body -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../shared/data.js"></script>
    <script src="../assets/js/dashboard.js"></script>
    <script src="../assets/js/configuration.js"></script>
    <script src="../assets/js/services-manager.js"></script>
    <!-- Biblioth√®que PDF -->
</body>
</html>